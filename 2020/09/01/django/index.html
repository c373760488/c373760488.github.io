<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="django相关知识 django5 个中间件  process_request process_view process_response process_exception process_render_template">
<meta property="og:type" content="article">
<meta property="og:title" content="django">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2020&#x2F;09&#x2F;01&#x2F;django&#x2F;index.html">
<meta property="og:site_name" content="Coye&#39;s blog">
<meta property="og:description" content="django相关知识 django5 个中间件  process_request process_view process_response process_exception process_render_template">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-09-09T11:28:02.661Z">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/09/01/django/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>django | Coye's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Coye's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">给自己看的=。=</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/01/django/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Coye">
      <meta itemprop="description" content="记录测试的点点滴滴。。。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coye's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          django
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-01 09:59:06" itemprop="dateCreated datePublished" datetime="2020-09-01T09:59:06+08:00">2020-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-09 19:28:02" itemprop="dateModified" datetime="2020-09-09T19:28:02+08:00">2020-09-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="django"><a href="#django" class="headerlink" title="django"></a>django</h2><h3 id="相关知识"><a href="#相关知识" class="headerlink" title="相关知识"></a>相关知识</h3><ul>
<li><p>django5 个中间件</p>
<ul>
<li>process_request</li>
<li>process_view</li>
<li>process_response</li>
<li>process_exception</li>
<li>process_render_template<a id="more"></a></li>
</ul>
</li>
<li><p>使用中间件做过什么</p>
<ul>
<li><p>权限</p>
</li>
<li><p>用户登录验证</p>
</li>
<li><p>django 的 csrf 是如何实现的<br>process_view 方法</p>
<ul>
<li><p>检查试图是否被@csrf_exempt(<code>from.views.decorators.csrf import csrf_exempt</code>免除该视图 csrf 认证)(CBV)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#CBV使用方式</span></span><br><span class="line"><span class="keyword">from</span> django.utils.decorators <span class="keyword">import</span> method_decorator</span><br><span class="line"><span class="meta">@method_decorator(csrf_exempt,name='dispatch')</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(view)</span>:</span></span><br><span class="line">    <span class="comment">#@method_decorator(csrf_exempt) #这种也行</span></span><br><span class="line">    <span class="comment">#def dispatch(self,request,*args,**kwargs):</span></span><br><span class="line">        <span class="comment">#return super(A,self).dispatch(request,*args,**kwargs)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request,*args,**kwargs)</span></span></span><br><span class="line"><span class="function">        <span class="title">pass</span></span></span><br><span class="line"><span class="function">    ...</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>@csrf_protect 该装饰器使视图需要被 csrf 认证（setting 中注释了 django.middleware.csrf.CsrfViewMiddleware）(CBV)</p>
</li>
<li><p>去请求体或 cookie 中获取 token</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>静态文件路径配置</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">"templates/static"</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><p>路由</p>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">'api/private/v1/'</span>,include(<span class="string">"mysite.urls"</span>)),</span><br><span class="line">    path(<span class="string">''</span>, TemplateView.as_view(template_name=<span class="string">"index.html"</span>)),</span><br><span class="line">    path(<span class="string">'favicon.ico'</span>, RedirectView.as_view(url=<span class="string">'static/favicon.ico'</span>)),</span><br><span class="line">    path(<span class="string">"login"</span>,views.AuthView.as_view()),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="restful-规范"><a href="#restful-规范" class="headerlink" title="restful 规范"></a>restful 规范</h3><ul>
<li><p>协议</p>
<p>API 与用户的通信协议，总是使用 HTTPs 协议。</p>
</li>
<li><p>域名</p>
<p>应该尽量将 API 部署在专用域名之下。<br><a href="https://api.example.com" target="_blank" rel="noopener">https://api.example.com</a> （需要考虑跨域）<br>如果确定 API 很简单，不会有进一步扩展，可以考虑放在主域名下。<br><a href="https://example.org/api/" target="_blank" rel="noopener">https://example.org/api/</a> （简单）</p>
</li>
<li><p>版本</p>
<p>应该将 API 的版本号放入 URL。<br><a href="https://api.example.com/v1/" target="_blank" rel="noopener">https://api.example.com/v1/</a><br>另一种做法是，将版本号放在 HTTP 头信息中，但不如放入 URL 方便和直观。Github 采用这种做法。</p>
</li>
<li><p>路径</p>
<p>路径又称”终点”（endpoint），表示 API 的具体网址。<br>在 RESTful 架构中，每个网址代表一种资源（resource），所以网址中不能有动词，只能有名词，而且所用的名词往往与数据库的表格名对应。一般来说，数据库中的表都是同种记录的”集合”（collection），所以 API 中的名词也应该使用复数。<br>举例来说，有一个 API 提供动物园（zoo）的信息，还包括各种动物和雇员的信息，则它的路径应该设计成下面这样。<br><a href="https://api.example.com/v1/zoos" target="_blank" rel="noopener">https://api.example.com/v1/zoos</a><br><a href="https://api.example.com/v1/animals" target="_blank" rel="noopener">https://api.example.com/v1/animals</a><br><a href="https://api.example.com/v1/employees" target="_blank" rel="noopener">https://api.example.com/v1/employees</a></p>
</li>
<li><p>HTTP 动词</p>
<p>对于资源的具体操作类型，由 HTTP 动词表示。<br>常用的 HTTP 动词有下面五个（括号里是对应的 SQL 命令）。<br>GET（SELECT）：从服务器取出资源（一项或多项）。<br>POST（CREATE）：在服务器新建一个资源。<br>PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。<br>PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）。<br>DELETE（DELETE）：从服务器删除资源。</p>
<p>还有两个不常用的 HTTP 动词。<br>HEAD：获取资源的元数据。<br>OPTIONS：获取信息，关于资源的哪些属性是客户端可以改变的。</p>
<p>下面是一些例子。<br>GET /zoos：列出所有动物园<br>POST /zoos：新建一个动物园<br>GET /zoos/ID：获取某个指定动物园的信息<br>PUT /zoos/ID：更新某个指定动物园的信息（提供该动物园的全部信息）<br>PATCH /zoos/ID：更新某个指定动物园的信息（提供该动物园的部分信息）<br>DELETE /zoos/ID：删除某个动物园<br>GET /zoos/ID/animals：列出某个指定动物园的所有动物<br>DELETE /zoos/ID/animals/ID：删除某个指定动物园的指定动物</p>
</li>
<li><p>过滤信息</p>
<p>如果记录数量很多，服务器不可能都将它们返回给用户。API 应该提供参数，过滤返回结果。<br>下面是一些常见的参数。<br>?limit=10：指定返回记录的数量<br>?offset=10：指定返回记录的开始位置。<br>?page=2&amp;per_page=100：指定第几页，以及每页的记录数。<br>?sortby=name&amp;order=asc：指定返回结果按照哪个属性排序，以及排序顺序。<br>?animal_type_id=1：指定筛选条件<br>参数的设计允许存在冗余，即允许 API 路径和 URL 参数偶尔有重复。比如，GET /zoo/ID/animals 与 GET /animals?zoo_id=ID 的含义是相同的。</p>
</li>
<li><p>状态码</p>
<p>服务器向用户返回的状态码和提示信息，常见的有以下一些（方括号中是该状态码对应的 HTTP 动词）。<br>200 OK - [GET]：服务器成功返回用户请求的数据，该操作是幂等的（Idempotent）。<br>201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。<br>202 Accepted - [<em>]：表示一个请求已经进入后台排队（异步任务）<br>204 NO CONTENT - [DELETE]：用户删除数据成功。<br>400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作，该操作是幂等的。<br>401 Unauthorized - [</em>]：表示用户没有权限（令牌、用户名、密码错误）。<br>403 Forbidden - [<em>] 表示用户得到授权（与 401 错误相对），但是访问是被禁止的。<br>404 NOT FOUND - [</em>]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。<br>406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求 JSON 格式，但是只有 XML 格式）。<br>410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。<br>422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。<br>500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。</p>
</li>
<li><p>错误处理</p>
<p>如果状态码是 4xx，就应该向用户返回出错信息。一般来说，返回的信息中将 error 作为键名，出错信息作为键值即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  error: <span class="string">"Invalid API key"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回结果</p>
</li>
</ul>
<p>针对不同操作，服务器向用户返回的结果应该符合以下规范。<br>GET /collection：返回资源对象的列表（数组）<br>GET /collection/resource：返回单个资源对象<br>POST /collection：返回新生成的资源对象<br>PUT /collection/resource：返回完整的资源对象<br>PATCH /collection/resource：返回完整的资源对象<br>DELETE /collection/resource：返回一个空文档</p>
<ul>
<li>Hypermedia API</li>
</ul>
<p>RESTful API 最好做到 Hypermedia，即返回结果中提供链接，连向其他 API 方法，使得用户不查文档，也知道下一步应该做什么。<br>比如，当用户向 api.example.com 的根目录发出请求，会得到这样一个文档。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"link"</span>: &#123;</span><br><span class="line">  <span class="string">"rel"</span>:   <span class="string">"collection https://www.example.com/zoos"</span>,</span><br><span class="line">  <span class="string">"href"</span>:  <span class="string">"https://api.example.com/zoos"</span>,</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"List of zoos"</span>,</span><br><span class="line">  <span class="string">"type"</span>:  <span class="string">"application/vnd.yourformat+json"</span></span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码表示，文档中有一个 link 属性，用户读取这个属性就知道下一步该调用什么 API 了。rel 表示这个 API 与当前网址的关系（collection 关系，并给出该 collection 的网址），href 表示 API 的路径，title 表示 API 的标题，type 表示返回类型。</p>
<p>Hypermedia API 的设计被称为 HATEOAS。Github 的 API 就是这种设计，访问 api.github.com 会得到一个所有可用 API 的网址列表。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"current_user_url"</span>: <span class="string">"https://api.github.com/user"</span>,</span><br><span class="line">  <span class="string">"authorizations_url"</span>: <span class="string">"https://api.github.com/authorizations"</span>,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从上面可以看到，如果想获取当前用户的信息，应该去访问 api.github.com/user，然后就得到了下面结果。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"message"</span>: <span class="string">"Requires authentication"</span>,</span><br><span class="line">  <span class="string">"documentation_url"</span>: <span class="string">"https://developer.github.com/v3"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码表示，服务器给出了提示信息，以及文档的网址。</p>
<h2 id="rest-framework"><a href="#rest-framework" class="headerlink" title="rest framework"></a>rest framework</h2><h3 id="用户认证"><a href="#用户认证" class="headerlink" title="用户认证"></a>用户认证</h3><p>在 setting 中添加</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK=&#123;</span><br><span class="line">    <span class="string">"DEFAULT_AUTHENTICATION_CLASSES"</span>:[<span class="string">"mysite.utils.auth.Authtication"</span>], <span class="comment">#可以添加多个</span></span><br><span class="line">    <span class="string">"UNAUTHENTICATED_USER"</span>:<span class="literal">None</span>, <span class="comment">#匿名，request.user为None</span></span><br><span class="line">    <span class="string">"UNAUTHENTICATED_TOKEN"</span>:<span class="literal">None</span>, <span class="comment">#匿名，request.auth为None</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#utils目录下</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Authtication</span><span class="params">(BaseAuthtication)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        token = request.request.GET.get(<span class="string">"token"</span>)</span><br><span class="line">        token_obj = models.UserToken.objects.filter(token=token).first()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token_obj:</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(<span class="string">"用户认证失败"</span>)</span><br><span class="line">        <span class="comment"># 在rest framework内部会将整个两个字段赋值绐request，以供后续麟作使用</span></span><br><span class="line">        <span class="keyword">return</span> token_obj.user, token_obj</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate_header</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="comment">#认证失败时，返回的响应头</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#views文件中</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">orderview</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="comment"># 订嬴相关业务</span></span><br><span class="line"></span><br><span class="line">    authentication_classes = [Authtication, ] <span class="comment">#在setting中配置以后就不用写了，如果不需要认证，这里设置空数组</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># request.user</span></span><br><span class="line">        <span class="comment"># request.auth</span></span><br><span class="line">        ret = &#123;<span class="string">"code"</span>: <span class="number">1001</span>, <span class="string">"msg"</span>: <span class="literal">None</span>, <span class="string">"data"</span>: <span class="literal">None</span>&#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ret[<span class="string">"data"</span>] = ORDER_DICT  <span class="comment"># 数据库取来的数据</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(ret)</span><br></pre></td></tr></table></figure>

<h4 id="梳理"><a href="#梳理" class="headerlink" title="梳理"></a>梳理</h4><p>使用</p>
<ul>
<li><p>创建类：集成 BaseAuthentication: 实现：authenticate 方法</p>
</li>
<li><p>返回信息： - None，我不管了，下一认证来执行。 - raise exceptions.AuthenticationFailed(“用户认证失败”) #from test_framework import exception - （元素 1，元素 2） #元素 1 复制给 request.user;元素 2 赋值给 request.auth</p>
<pre><code>- 局部使用（创建类，接口类中重写authentication_classes = [Authtication, ]）
- 全局使用（配置setting）</code></pre><p>源码流程</p>
</li>
<li><p>dispatch</p>
<ul>
<li>封装 request<ul>
<li>获取定义的认证类（全局/局部），通过列表生成时创建对象</li>
</ul>
</li>
<li>initial<ul>
<li>perform_authentication<br>request.user(内部循环。。。)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h3><p>类似用户认证</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPermission</span><span class="params">(BasePermission)</span>:</span></span><br><span class="line">    message=<span class="string">"必须是SVIP才能访问"</span> <span class="comment">#返回的错误信息</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">has_permission</span><span class="params">(self, request,view)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> request.user.rid==<span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">orderview</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="comment"># 订嬴相关业务</span></span><br><span class="line"></span><br><span class="line">    permission_classes = [MyPermission, ]</span><br><span class="line"></span><br><span class="line"><span class="comment">#setting中</span></span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAULT_PERMISSION_CLASSES"</span>:[<span class="string">"mysite.utils.permission.MyPermission"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="访问频率"><a href="#访问频率" class="headerlink" title="访问频率"></a>访问频率</h3><p>自定义</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">VISIT_RECORD=&#123;&#125; <span class="comment">#访问记录保存，可以用redis替换</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IPThrottle</span><span class="params">(BaseThorttle)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.hostory=<span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_request</span><span class="params">(self,request,view)</span>:</span></span><br><span class="line">        remote_addr = request.META.get(<span class="string">"REMOTE_ADDR"</span>)</span><br><span class="line">        ctime =time.time()</span><br><span class="line">        <span class="keyword">if</span> remote_addr <span class="keyword">not</span> <span class="keyword">in</span> VISIT_RECORD:</span><br><span class="line">            VISIT_RECORD[remote_addr]=[ctime]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span> <span class="comment">#没有访问过添加记录，并允许访问</span></span><br><span class="line">        history = VISIT_RECORD[remote_addr]</span><br><span class="line">        self.hostory=history</span><br><span class="line">        <span class="keyword">while</span> history <span class="keyword">and</span> history[<span class="number">-1</span>]&lt; ctime<span class="number">-60</span>:</span><br><span class="line">            history.pop()   <span class="comment">#把过期的时间去掉</span></span><br><span class="line">        <span class="keyword">if</span> len(history)&lt;<span class="number">3</span>:  <span class="comment">#1分钟内只允许访问3次</span></span><br><span class="line">            history.insert(<span class="number">0.</span>ctime)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wait</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment">#还需要多少秒才能访问</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">60</span>-(time.time()-self.history[<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">orderview</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="comment"># 订嬴相关业务</span></span><br><span class="line"></span><br><span class="line">    throttle_classes = [IPThrottle, ]</span><br><span class="line"></span><br><span class="line"><span class="comment">#如果做全局setting配置，接口不必再写throttle_classes = [IPThrottle, ]</span></span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_CLASSES"</span>:[<span class="string">"mysite.utils.throtle.IPThrottle"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用框架的,利用缓存</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#根据ip</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IPThrottle</span><span class="params">(SimpleRateThrottle)</span>:</span></span><br><span class="line">    scope=<span class="string">"IPpinlv"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cache_key</span><span class="params">(self,request,view)</span>:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.get_ident(request)</span><br><span class="line"></span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_CLASSES"</span>:[<span class="string">"mysite.utils.throtle.IPThrottle"</span>]</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_RATES"</span>:&#123;<span class="string">"IPpinlv"</span>:<span class="string">'3/m'</span>&#125; <span class="comment">#一分钟3次</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#根据用户名</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserThrottle</span><span class="params">(SimpleRateThrottle)</span>:</span></span><br><span class="line">    scope=<span class="string">"Userpinlv"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cache_key</span><span class="params">(self,request,view)</span>:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> request.user.username</span><br><span class="line"></span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_CLASSES"</span>:[<span class="string">"mysite.utils.throtle.UserThrottle"</span>]</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_RATES"</span>:&#123;<span class="string">"Userpinlv"</span>:<span class="string">'3/m'</span>&#125; <span class="comment">#一分钟3次</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>没有登录的用 ip 限制，登录的可以用用户名限制（把 user 的写到配置做全局，ip 的单独添加到接口类）</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_CLASSES"</span>:[<span class="string">"mysite.utils.throtle.UserThrottle"</span>]</span><br><span class="line">    <span class="string">"DEFAULT_THROTLE_RATES"</span>:&#123;<span class="string">"Userpinlv"</span>:<span class="string">'3/m'</span>&#125; <span class="comment">#一分钟3次</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#-----------</span></span><br><span class="line">throttle_classes = [IPThrottle, ]</span><br></pre></td></tr></table></figure>

<p>梳理：</p>
<ul>
<li>基本使用：<ul>
<li>类，继承：BaseThrottle,实现：allow_request、wait</li>
<li>类，继承：SimpleRateThrottle,实现：get_cache_key、scope=”ippinlv”(配置文件中的 key)</li>
</ul>
</li>
<li>局部（继承重写类，接口加 throttle_classes = [IPThrottle, ] ）</li>
<li>全局（继承重写类，改写配置文件）</li>
</ul>
<h3 id="框架版本"><a href="#框架版本" class="headerlink" title="框架版本"></a>框架版本</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自己写，通过urlget传参的（不用自己写，用框架自带的就好）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ParamVersion</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">determine_version</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        version = request.query_params.get(<span class="string">"version"</span>)</span><br><span class="line">        <span class="keyword">return</span> version</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    versioning_class=ParamVersion</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#框架自带,需要配置</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.versioning <span class="keyword">import</span> QueryParameterVersioniong</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    versioning_class=QueryParameterVersioniong</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        print(request.version)</span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAULT_VERSION"</span>:<span class="string">"v1"</span>, <span class="comment">#请求不带版本参数默认使用的接口版本</span></span><br><span class="line">    <span class="string">"ALLOWED_VERSIONS"</span>:[<span class="string">"v1"</span>,<span class="string">"v2"</span>],<span class="comment">#请求允许传的版本</span></span><br><span class="line">    <span class="string">"VERSION_PARAM"</span>:<span class="string">"version"</span>, <span class="comment">#请求中版本参数的key 比如http://localhost/api?version=v1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#框架自带，推荐使用</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="comment">#获取版本</span></span><br><span class="line">        print(request.version)</span><br><span class="line">        <span class="comment">#获取处理版本的对象</span></span><br><span class="line">        print(request.version_scheme)</span><br><span class="line">        <span class="comment">#反向生成url,uuu为view页面路由别名（name="uuu"）</span></span><br><span class="line">        u=request.versioning_scheme.reverse(viewname=<span class="string">"uuu"</span>,request=request)</span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAILT_VERSIONING_CLASS"</span>:<span class="string">"rest_framework.versiong.URLPathVersioning"</span></span><br><span class="line">    <span class="string">"DEFAULT_VERSION"</span>:<span class="string">"v1"</span>, <span class="comment">#请求不带版本参数默认使用的接口版本</span></span><br><span class="line">    <span class="string">"ALLOWED_VERSIONS"</span>:[<span class="string">"v1"</span>,<span class="string">"v2"</span>],<span class="comment">#请求允许传的版本</span></span><br><span class="line">    <span class="string">"VERSION_PARAM"</span>:<span class="string">"version"</span>, <span class="comment">#请求中版本参数的key 比如http://localhost/api?version=v1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="解析器"><a href="#解析器" class="headerlink" title="解析器"></a>解析器</h3><ul>
<li>前戏：django：request.POST/ request.body<ul>
<li>请求头要求：<br>如果请求头中的 Content-Type:application/x-www-form-urlencoded,request.POST 中才有值（去 request.body 中解析数据）。</li>
<li>数据格式要求：<br>nane=alex&amp;age=18&amp;gener=男<br>如：<br>a. from 表单提交默认格式就是以上两种<br>b. ajax()<br>其他：<br>a. #换成 json，request.POST 中取不到数据，数据在 reqiest.body<br>ajax({<br>headers:{Content-Type:application/json}<br>data:{name:coye,age:30}<br>})<br>b.<br>#body 有值，POST 无值，后台需要 json.loads(request.body)<br>ajax({<br>headers:{Content-Type:application/json}<br>data:JSON.stringfy({name:coye,age:30})<br>})</li>
</ul>
</li>
<li>例子</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#setting中配置</span></span><br><span class="line">REST_FRAMEWORK =&#123;</span><br><span class="line">    <span class="string">"DEFAILT_PARSER_CLASSES"</span>:[<span class="string">"rest_framework.parsers.JSONParser"</span>,<span class="string">"rest_framework.parsers.FormParser"</span>]</span><br><span class="line">&#125;<span class="comment">#还有其他种类请求头可以添加</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.parsers <span class="keyword">import</span> JSONParser，FormParser</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ParserView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="comment">#单独配置  parser_classes=["FileUploadParser"]</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request, *args, **kwargs)</span>:</span></span><br><span class="line">        print(request.data) <span class="comment">#使用该方法获取参数</span></span><br><span class="line">        print(request.data.get(<span class="string">"xxx"</span>))</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><h4 id="序列化链表"><a href="#序列化链表" class="headerlink" title="序列化链表"></a>序列化链表</h4><p>model 文件</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    user_type_choices =(</span><br><span class="line">        (<span class="number">1</span>,<span class="string">'普通用户'</span>),</span><br><span class="line">        (<span class="number">2</span>,<span class="string">'VIP'</span>),</span><br><span class="line">        (<span class="number">3</span>,<span class="string">'SVIP'</span>),</span><br><span class="line">    )</span><br><span class="line">    user_type=models.IntegerField(choices=user_type_choices)</span><br><span class="line">    username = models.CHarField(max_length=<span class="number">32</span>,unique=<span class="literal">True</span>)</span><br><span class="line">    password = models.CharField(max_length=<span class="number">64</span>)</span><br><span class="line">    group = models.ForeignKey(to=<span class="string">"UserInfo"</span>)</span><br><span class="line">    roles = models.ManyToManyField(<span class="string">'Role'</span>)</span><br></pre></td></tr></table></figure>

<p>serializers 文件<br>麻烦的序列化链表</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoSerializer</span><span class="params">(serializers.Serializer)</span>:</span></span><br><span class="line">    <span class="comment">#变量名会变成结果中的key</span></span><br><span class="line">    username = serializers.CharField()</span><br><span class="line">    password = serializers.CharField()</span><br><span class="line">    <span class="comment">#什么都不写，变量名需要与model一直，如果加上source，变量名随意，值都为123</span></span><br><span class="line">    user_type_id = seriailizers.IntegerField(source=<span class="string">"user_type"</span>)</span><br><span class="line">    <span class="comment">#source='get_user_type_display'就可以获取到，值为普通用户，VIP，SVIP</span></span><br><span class="line">    user_type_name = seriailizers.IntegerField(source=<span class="string">"get_user_type_display"</span>)</span><br><span class="line">    <span class="comment">#获取用户对应group的title</span></span><br><span class="line">    gp = serializers.CharField(source=<span class="string">"group.title"</span>)</span><br><span class="line">    <span class="comment">#获取当前用户拥有的角色(多对多字段)</span></span><br><span class="line">    rls = serializers.SerializerMethodField()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_rls</span><span class="params">(self,row)</span>:</span></span><br><span class="line">        role_obj_list = row.roles.all()</span><br><span class="line">        ret= [&#123;<span class="string">"id"</span>:i.id,<span class="string">"title"</span>:i.title&#125; <span class="keyword">for</span> i <span class="keyword">in</span> role_obj_list]</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>

<p>views 文件</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request,*args,**kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># users = models.UserInfo.objects.all()</span></span><br><span class="line">        users = models.UserInfo.objects.filter(id=<span class="number">1</span>).first()</span><br><span class="line">        ser = UserInfoSerializer(instance=users,many=<span class="literal">True</span>)</span><br><span class="line">        ret=json.dumps(ser.data,ensure_ascil=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>

<ul>
<li>进一步手动化序列化链表</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    rls = serializers.SerializerMethodField()</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields=<span class="string">"__all__"</span> <span class="comment">#返回所有字段</span></span><br><span class="line">        depth=<span class="number">1</span> <span class="comment">#外键深度，这样能够显示group.title了建议最多3-4层。</span></span><br><span class="line">        <span class="comment">#混合使用</span></span><br><span class="line">        fields=[<span class="string">"id"</span>,<span class="string">"username"</span>,<span class="string">"password"</span>,<span class="string">"rls"</span>] <span class="comment">#注意rls</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">get_rls</span><span class="params">(self,row)</span>:</span></span><br><span class="line">            role_obj_list = row.roles.all()</span><br><span class="line">            ret= [&#123;<span class="string">"id"</span>:i.id,<span class="string">"title"</span>:i.title&#125; <span class="keyword">for</span> i <span class="keyword">in</span> role_obj_list]</span><br><span class="line">            <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>

<ul>
<li>自动化序列化链表</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields=<span class="string">"__all__"</span> <span class="comment">#返回所有字段</span></span><br><span class="line">        depth=<span class="number">1</span> <span class="comment">#外键深度，这样能够显示group.title了建议最多3-4层。</span></span><br></pre></td></tr></table></figure>

<h4 id="根据字段自动生成链接"><a href="#根据字段自动生成链接" class="headerlink" title="根据字段自动生成链接"></a>根据字段自动生成链接</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    <span class="comment">#gp是视图页面的路由别名,路由是url的里面有证则xxx就是里面的正则，需要的时候在具体研究吧</span></span><br><span class="line">    group=serializers.HyperlinkedIdentityField(view_name=<span class="string">"gp"</span>,lookup_filed:<span class="string">"group_id"</span>,lookup_url_kwargs:<span class="string">"xxx"</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = models.UserInfo</span><br><span class="line">        fields=[<span class="string">"id"</span>,<span class="string">"username"</span>,<span class="string">"password"</span>,<span class="string">"group"</span>]</span><br><span class="line">        depth=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self,request,*args,**kwargs)</span>:</span></span><br><span class="line">        <span class="comment"># users = models.UserInfo.objects.all()</span></span><br><span class="line">        users = models.UserInfo.objects.all()</span><br><span class="line">        ser = UserInfoSerializer(instance=users,many=<span class="literal">True</span>,context=&#123;<span class="string">"request"</span>:request&#125;)</span><br><span class="line">        ret=json.dumps(ser.data,ensure_ascil=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>

<h4 id="请求数据校验"><a href="#请求数据校验" class="headerlink" title="请求数据校验"></a>请求数据校验</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UsernameValidator</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__inint__</span><span class="params">(self,base)</span>:</span></span><br><span class="line">        self.base = str(base)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self,value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> value != self.base:</span><br><span class="line">            message = <span class="string">"用户名必须以%s为开头"</span> % self.base</span><br><span class="line">            <span class="keyword">raise</span> serializers.ValidationError(message)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_context</span><span class="params">(self,serializer_field)</span>:</span></span><br><span class="line">        <span class="comment">#执行验证之前调用，serializer_fields是当前字段对象</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoSerializer</span><span class="params">(serializers.ModelSerializer)</span>:</span></span><br><span class="line">    username=serializers.CharField(error_messages=&#123;<span class="string">"required"</span>:<span class="string">"标题不能为空"</span>&#125;，validators=[UsernameValidator(<span class="string">"老男人)])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class UserInfoView(APIView):</span></span><br><span class="line"><span class="string">    def post(self,request,*args,**kwargs):</span></span><br><span class="line"><span class="string">        ser = UserInfoSerializer(data=request.data)</span></span><br><span class="line"><span class="string">        if ser.is_valid():</span></span><br><span class="line"><span class="string">            print(ser.validated_data["</span>username<span class="string">"])</span></span><br><span class="line"><span class="string">        else:</span></span><br><span class="line"><span class="string">            print(ser.errors)</span></span><br><span class="line"><span class="string">        return HttpResponse("</span>提交数据<span class="string">")</span></span><br></pre></td></tr></table></figure>

<h4 id="渲染功能"><a href="#渲染功能" class="headerlink" title="渲染功能"></a>渲染功能</h4><p>setting 的 INSTALLED_APPS 中添加”rest_framework”</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfoView</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request,*args,**kwargs)</span>:</span></span><br><span class="line">        ser = UserInfoSerializer(data=request.data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Response(ser.data)</span><br></pre></td></tr></table></figure>

<h4 id="分页功能"><a href="#分页功能" class="headerlink" title="分页功能"></a>分页功能</h4><p>page 方式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#localhost/pager1View?page=2&amp;size=3  显示第第二页，一页3个</span></span><br><span class="line">REST_FRAMEWORK=&#123;</span><br><span class="line">    <span class="string">"PAGE_SIZE"</span>:<span class="number">2</span> <span class="comment">#一页显示两个</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">from</span> rest_framework.pagination <span class="keyword">import</span> PageNumberpagination</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPageNumberPagination</span><span class="params">(PageNumberpagination)</span>:</span></span><br><span class="line">    page_size=<span class="number">2</span> <span class="comment">#每页显示多少</span></span><br><span class="line">    page_size_query_param=<span class="string">"size"</span>    <span class="comment">#参数key</span></span><br><span class="line">    max_page_size=<span class="number">5</span> <span class="comment">#每页最多显示多少</span></span><br><span class="line">    page_query_param=<span class="string">"page"</span> <span class="comment">#参数key</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pager1View</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request,*args,**kwargs)</span>:</span></span><br><span class="line">        <span class="comment">#获取所有数据</span></span><br><span class="line">        roles = models.Role.objects.all()</span><br><span class="line">        <span class="comment">#创建分页对象</span></span><br><span class="line">        <span class="comment"># pg=pageNumberPagination() #只能配置setting的PAGE_SIZE</span></span><br><span class="line">        pg=MyPageNumberPagination() <span class="comment">#配置多个参数</span></span><br><span class="line">        <span class="comment">#在数据库中获取分页的数据</span></span><br><span class="line">        pager_roles = pg.paginate_queryset(query=roles,request=request,view=self)</span><br><span class="line">        对数据进行序列化</span><br><span class="line">        ser = PagerSerialiser(instance=pager_roles,many=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> pg.get_paginated_response(ser.data)</span><br></pre></td></tr></table></figure>

<p>offset 方式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#localhost/pager1View?offset=0&amp;size=3  显示第1页，一页3个</span></span><br><span class="line">REST_FRAMEWORK=&#123;</span><br><span class="line">    <span class="string">"PAGE_SIZE"</span>:<span class="number">2</span> <span class="comment">#默认显示两个</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">from</span> rest_framework.pagination <span class="keyword">import</span> LimitOffserPagination</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPageNumberPagination</span><span class="params">(LimitOffserPagination)</span>:</span></span><br><span class="line">    default_limit=<span class="number">2</span></span><br><span class="line">    limit_query_param=<span class="string">"limit"</span></span><br><span class="line">    offset_query_param=<span class="string">"offset"</span></span><br><span class="line">    max_limit=<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pager1View</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request,*args,**kwargs)</span>:</span></span><br><span class="line">        <span class="comment">#获取所有数据</span></span><br><span class="line">        roles = models.Role.objects.all()</span><br><span class="line">        <span class="comment">#创建分页对象</span></span><br><span class="line">        pg=LimitOffserPagination() <span class="comment">#只能配置setting的PAGE_SIZE</span></span><br><span class="line">        pg=MyPageNumberPagination() <span class="comment">#配置多个参数</span></span><br><span class="line">        <span class="comment">#在数据库中获取分页的数据</span></span><br><span class="line">        pager_roles = pg.paginate_queryset(query=roles,request=request,view=self)</span><br><span class="line">        对数据进行序列化</span><br><span class="line">        ser = PagerSerialiser(instance=pager_roles,many=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> pg.get_paginated_response(ser.data)</span><br></pre></td></tr></table></figure>

<p>加密方式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#localhost/pager1View?offset=0&amp;size=3  显示第1页，一页3个</span></span><br><span class="line">REST_FRAMEWORK=&#123;</span><br><span class="line">    <span class="string">"PAGE_SIZE"</span>:<span class="number">2</span> <span class="comment">#默认显示两个</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">from</span> rest_framework.pagination <span class="keyword">import</span> CursorPagination</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPageNumberPagination</span><span class="params">(CursorPagination)</span>:</span></span><br><span class="line">    cursor_query_param = <span class="string">"cursor"</span></span><br><span class="line">    page_size =<span class="number">2</span></span><br><span class="line">    ordering = <span class="string">"id"</span></span><br><span class="line">    page_size_query_param = <span class="literal">None</span></span><br><span class="line">    max_page_size = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pager1View</span><span class="params">(APIView)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self,request,*args,**kwargs)</span>:</span></span><br><span class="line">        <span class="comment">#获取所有数据</span></span><br><span class="line">        roles = models.Role.objects.all()</span><br><span class="line">        <span class="comment">#创建分页对象</span></span><br><span class="line">        pg=CursorPagination() <span class="comment">#只能配置setting的PAGE_SIZE</span></span><br><span class="line">        pg=MyPageNumberPagination() <span class="comment">#配置多个参数</span></span><br><span class="line">        <span class="comment">#在数据库中获取分页的数据</span></span><br><span class="line">        pager_roles = pg.paginate_queryset(query=roles,request=request,view=self)</span><br><span class="line">        对数据进行序列化</span><br><span class="line">        ser = PagerSerialiser(instance=pager_roles,many=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> pg.get_paginated_response(ser.data)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/09/01/vue%E8%84%9A%E6%89%8B%E6%9E%B6/" rel="prev" title="vue脚手架">
      <i class="fa fa-chevron-left"></i> vue脚手架
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#django"><span class="nav-number">1.</span> <span class="nav-text">django</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#相关知识"><span class="nav-number">1.1.</span> <span class="nav-text">相关知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#restful-规范"><span class="nav-number">1.2.</span> <span class="nav-text">restful 规范</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rest-framework"><span class="nav-number">2.</span> <span class="nav-text">rest framework</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#用户认证"><span class="nav-number">2.1.</span> <span class="nav-text">用户认证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#梳理"><span class="nav-number">2.1.1.</span> <span class="nav-text">梳理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用户权限"><span class="nav-number">2.2.</span> <span class="nav-text">用户权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#访问频率"><span class="nav-number">2.3.</span> <span class="nav-text">访问频率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#框架版本"><span class="nav-number">2.4.</span> <span class="nav-text">框架版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解析器"><span class="nav-number">2.5.</span> <span class="nav-text">解析器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#序列化"><span class="nav-number">2.6.</span> <span class="nav-text">序列化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#序列化链表"><span class="nav-number">2.6.1.</span> <span class="nav-text">序列化链表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#根据字段自动生成链接"><span class="nav-number">2.6.2.</span> <span class="nav-text">根据字段自动生成链接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#请求数据校验"><span class="nav-number">2.6.3.</span> <span class="nav-text">请求数据校验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#渲染功能"><span class="nav-number">2.6.4.</span> <span class="nav-text">渲染功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分页功能"><span class="nav-number">2.6.5.</span> <span class="nav-text">分页功能</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Coye"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Coye</p>
  <div class="site-description" itemprop="description">记录测试的点点滴滴。。。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">45</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Coye</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
